/*! reef v2.0.1 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):t.Reef=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(s){"use strict";var c,o=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},l=function(t){if(t)return JSON.parse(JSON.stringify(t))},u=function(t,e){var n=t.filter(e);return n.length<1?null:n[0]},t=function(t,e){if(!(function(){if(!s.DOMParser)return!1;c=c||new DOMParser;try{c.parseFromString("x","text/html")}catch(t){return!1}return!0})())throw new Error("Reef.js is not supported by this browser.");if(!(t||e&&e.lagoon))throw new Error("Reef.js: You did not provide an element to make into a component.");if(!e||!e.template&&!e.lagoon)throw new Error("Reef.js: You did not provide a template for this component.");if(this.elem=t,this.data=e.data,this.template=e.template,this.sanitize=void 0===typeof e.sanitize||e.sanitize,this.sanitizeOptions=e.sanitizeOptions||{},this.attached=[],this.lagoon=e.lagoon,e.attachTo){var n=this;e.attachTo.forEach((function(t){"attach"in t&&t.attach(n)}))}},f=function(e,t){t.forEach((function(t){e.style[t]=""}))},a=function(i,t){t.forEach((function(t){var n,e,o,r,a;"class"===t.att?i.className=t.value:"style"===t.att?(n=i,e=t.value,r=e.split(";").filter((function(t){return 0<t.indexOf(":")})).map((function(t){var e=t.split(":");return{name:e[0]?e[0].trim():"",value:e[1]?e[1].trim():""}})),a=Array.prototype.filter.call(n.style,(function(e){return null===u(r,(function(t){return t.name===e&&t.value===n.style[e]}))})),f(n,a),o=n,r.forEach((function(t){o.style[t.name]=t.value}))):i.setAttribute(t.att,t.value||!0)}))},i=function(t){var e;return e="text"===t.type?document.createTextNode(t.content):"comment"===t.type?document.createComment(t.content):t.isSVG?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type),a(e,t.atts),0<t.children.length?t.children.forEach((function(t){e.appendChild(i(t))})):"text"!==t.type&&(e.textContent=t.content),e},h=function(t,n){var e,o=n.atts.filter((function(e){return null===u(t.atts,(function(t){return e.att===t.att}))})),r=t.atts.filter((function(e){var t=u(n.atts,(function(t){return e.att===t.att}));return null===t||t.value!==e.value}));a(n.node,r),e=n.node,o.forEach((function(t){"class"===t.att?e.className="":"style"===t.att?f(e,Array.prototype.slice.call(e.style)):e.removeAttribute(t.att)}))},p=function(n,o,r,a){var t=o.length-n.length;if(0<t)for(;0<t;t--)o[o.length-t].node.parentNode.removeChild(o[o.length-t].node);n.forEach((function(e,t){o[t]?n[t].type===o[t].type?(h(n[t],o[t]),0<a.filter((function(t){return 3!==e.node.nodeType&&e.node.matches(t)})).length||(n[t].content!==o[t].content&&(o[t].node.textContent=n[t].content),0<e.children.length&&p(e.children,o[t].children||[],o[t].node,a))):o[t].node.parentNode.replaceChild(i(n[t]),o[t].node):r.appendChild(i(n[t]))}))},d=function(t,o){return Array.prototype.map.call(t.childNodes,(function(t){var e,n={content:t.childNodes&&0<t.childNodes.length?null:t.textContent,atts:1!==t.nodeType?[]:(e=t.attributes,Array.prototype.map.call(e,(function(t){return{att:t.name,value:t.value}}))),type:3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase(),node:t};return n.isSVG=o||"svg"===n.type,n.children=d(t,n.isSVG),n}))},m=function(t,e){t&&t.forEach((function(t){if(-1<t.attached.indexOf(e))throw new Error("ReefJS: "+e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};return t.prototype.render=function(){if(this.lagoon)m(this.attached,this);else{if(!this.template)throw new Error("Reef.js: No template was provided.");var t="string"==typeof this.elem?document.querySelector(this.elem):this.elem;if(!t)throw new Error("Reef.js: The DOM element to render your template into was not found.");var e="function"==typeof this.template?this.template(l(this.data)):this.template;if(-1!==["string","number"].indexOf(typeof e)){e=this.sanitize?(function(t,e){if(!s.DOMPurify)throw new Error("You are using the unsafe version of Reef. Please use the full version to sanitize your templates.");return DOMPurify.sanitize(t,e)})(e,this.sanitizeOptions):e;var n,o=d((n=e,(c=c||new DOMParser).parseFromString(n,"text/html").body)),r=d(t),a=this.attached.map((function(t){return t.elem}));if(p(o,r,t,a),"function"==typeof s.CustomEvent){var i=new CustomEvent("render",{bubbles:!0});t.dispatchEvent(i)}return m(this.attached,this),t}}},t.prototype.getData=function(){return l(this.data)},t.prototype.setData=function(t){if("object"!==o(t))throw new Error("ReefJS: The provided data is not an object.");for(var e in t)t.hasOwnProperty(e)&&(this.data[e]=t[e]);this.render()},t.prototype.attach=function(t){"array"===o(t)?Array.prototype.push.apply(this.attached,t):this.attached.push(t)},t.prototype.detach=function(e){var n="array"===o(e);this.attached=this.attached.filter((function(t){return n?-1===e.indexOf(t):t!==e}))},t}));